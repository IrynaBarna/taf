<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Test Automation Framework: Using Loggers Module</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Test Automation Framework
   &#160;<span id="projectnumber">01/31/17/16:21:23</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('use_log_module_page.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Using Loggers Module </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#use_log_module_sec1">Using loggers in test classes</a><ul><li class="level2"><a href="#use_log_autolog">Using of autolog fixture</a></li>
<li class="level2"><a href="#use_log_subsection1_1">(Obsoleted) define test suite logger</a></li>
<li class="level2"><a href="#log_message">Using logger object</a></li>
<li class="level2"><a href="#use_log_subsection1_2">SimSwitch and Vlab Output</a></li>
<li class="level2"><a href="#use_log_sshlog">Log ssh connections output in separate file</a></li>
</ul>
</li>
<li class="level1"><a href="#use_log_module_testlib">Using loggers in testlib modules</a><ul><li class="level2"><a href="#use_log_module_classes">Define class level logger</a></li>
<li class="level2"><a href="#use_log_module_modules">Define module level logger</a></li>
</ul>
</li>
<li class="level1"><a href="#use_log_module_cli_options">Loggers py.test CLI Options</a></li>
</ul>
</div>
<div class="textblock"><dl class="section user"><dt>The main purpose of usage TAF loggers module is to determinate clear enough path to log message source and to perform whole framework logging configuration in one place.</dt><dd></dd></dl>
<h1><a class="anchor" id="use_log_module_sec1"></a>
Using loggers in test classes</h1>
<dl class="section note"><dt>Note</dt><dd>Check logger usage example in &lt;git_root&gt;/taf-repo/tests/examples/logger_usage</dd></dl>
<h2><a class="anchor" id="use_log_autolog"></a>
Using of autolog fixture</h2>
<p>This method allows you to register all suite loggers in a single place in <a class="el" href="conftest_8py.html">conftest.py</a>. <em>"autolog"</em> fixture creates new logger instance for each class and delete this instance at class level teardown. In case you set autouse option you don't need to pass this fixture to test case (it will be passed automatically).</p>
<p>Read fixture template documentation here: testlib::fixtures::autolog</p>
<ol type="1">
<li>Define autolog fixture at the top level <a class="el" href="conftest_8py.html">conftest.py</a> file: <div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="keyword">import</span> pytest</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="keyword">from</span> testlib <span class="keyword">import</span> fixtures</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;@pytest.fixture(scope=<span class="stringliteral">&quot;class&quot;</span>, autouse=<span class="keyword">True</span>)</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="keyword">def </span>autolog(request):</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;    <span class="keywordflow">return</span> fixtures.autolog(request, <span class="stringliteral">&quot;suite_logger&quot;</span>)</div>
</div><!-- fragment --></li>
<li>Now you can use logger in test cases: <div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="keyword">class </span>TestClass(object):</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;    <span class="keyword">def </span>test_one():</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;        self.suite_logger.info(<span class="stringliteral">&quot;Hello!&quot;</span>)</div>
</div><!-- fragment --></li>
</ol>
<h2><a class="anchor" id="use_log_subsection1_1"></a>
(Obsoleted) define test suite logger</h2>
<dl class="section warning"><dt>Warning</dt><dd>This method is obsoleted and shouldn't be used for new suites. It's left here only as notice.</dd></dl>
<p>In each test class, add the following method: </p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="keyword">from</span> testlib <span class="keyword">import</span> loggers</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="keyword">class </span>TestClass(object):</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;    <span class="keyword">def </span>setup_class(self):</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;        self.suite_logger = loggers.ClassLogger()</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;        self.suite_logger.info(<span class="stringliteral">&quot;Starting &lt;THE NAME OF TEST SUITE&gt; test suite.&quot;</span>)</div>
</div><!-- fragment --><h2><a class="anchor" id="log_message"></a>
Using logger object</h2>
<p>Directly in test cases, use the following operator for logging: </p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;self.suite_logger.&lt;severity&gt;(<span class="stringliteral">&quot;Log text.&quot;</span>)</div>
</div><!-- fragment --><p> <b>Where:</b> <em>severity</em> - one of "critical", "error", "warning", "info", "debug" </p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;self.suite_logger.info(<span class="stringliteral">&quot;Setting new value to some property...&quot;</span>)</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;self.suite_logger.debug(<span class="stringliteral">&quot;Local variables: %s&quot;</span> % locals())</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;self.suite_logger.error(<span class="stringliteral">&quot;Test fail :&#39;( ...&quot;</span>)</div>
</div><!-- fragment --><h2><a class="anchor" id="use_log_subsection1_2"></a>
SimSwitch and Vlab Output</h2>
<p>In case running tests on simulated environments and selecting logging to file, SimSwitch and Vlab output also will be captured and placed to the files simswitch&lt;configID&gt;.output.log/vlab&lt;configID&gt;.output.log in the same folder with the main log.</p>
<h2><a class="anchor" id="use_log_sshlog"></a>
Log ssh connections output in separate file</h2>
<p><em>"sshlog"</em> fixture allows you to create separate file for each opened ssh session for each test case.</p>
<p><b>1</b>. <b>Define</b> <b>fixture:</b> </p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="keyword">from</span> testlib <span class="keyword">import</span> dev_switches</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;@pytest.fixture(autouse=<span class="keyword">True</span>)</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="keyword">def </span>ssh_logger(request):</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;    fixtures.sshlog(request, <span class="stringliteral">&quot;env&quot;</span>, SwitchGeneral)</div>
</div><!-- fragment --><p><b>Where:</b> </p>
<ul>
<li><em>"env"</em> - name of environment fixture</li>
<li><em>SwitchGeneral</em> - class (or tuple of classes) which contain <em>"ssh"</em> attribute and require SSH logger registration.</li>
</ul>
<p><b>2</b>. <b>Usage:</b> </p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="keyword">def </span>test_something(env):</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;    env.switch[1].ssh.exec_command(<span class="stringliteral">&quot;bla-bla-bla&quot;</span>)</div>
</div><!-- fragment --><p>After this you will see additional file in <em>logdir</em>. File name pattern: <b>&lt;test_func_name&gt;_&lt;py.test PID&gt;_id_&lt;entry id&gt;_type_&lt;entry type&gt;.log</b> E.g.: test_something_765_id_71_type_real.log</p>
<p>Read fixture template documentation here: testlib::fixtures::sshlog</p>
<h1><a class="anchor" id="use_log_module_testlib"></a>
Using loggers in testlib modules</h1>
<p>The main purpose of usage loggers module is to determinate clear enough path to log message source.</p>
<h2><a class="anchor" id="use_log_module_classes"></a>
Define class level logger</h2>
<p>Class level logger has to be defined in <b>class level</b> scope. </p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="keyword">import</span> Loggers</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="keyword">class </span>SomeClass(object):</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;    class_logger = loggers.ClassLogger()</div>
</div><!-- fragment --><h2><a class="anchor" id="use_log_module_modules"></a>
Define module level logger</h2>
<p>Module logger has to be used in all module functions and has to be defined in module global scope.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">#!/usr/bin/env python</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="keyword">import</span> loggers</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;mod_logger = loggers.module_logger(<span class="stringliteral">&quot;current_module_name&quot;</span>)</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="keyword">def </span>func():</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;    mod_logger.info(<span class="stringliteral">&quot;Hello!&quot;</span>)</div>
</div><!-- fragment --><h1><a class="anchor" id="use_log_module_cli_options"></a>
Loggers py.test CLI Options</h1>
<p>When running test cases use this additional options:</p>
<p><b>--loglevel=LOGLEVEL</b> - logging level, 'INFO' by default.</p>
<p><b>--logdir=LOGDIR</b> - name of directory where should be stored all log files, None by default.</p>
<p><b>--silent</b> - do not print logging to console. Disabled.</p>
<p><b>Example:</b> </p>
<pre class="fragment">$ sudo py.test --loglevel=DEBUG --logdir=/somewhere/on/pc --setup_file=setup.json functional/fdb/
</pre> </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Tue Jan 31 2017 16:21:23 for Test Automation Framework by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
